[{"title":"Intel SDM Volume 3A: Chapter 2","url":"/2025/11/19/Intel-SDM-Volume-3A-Chapter-2/","content":"\n[!NOTE]这章虽然内容不多，但详细介绍了Intel IA-32(e)架构的各个组成部分，以及提供给操作系统用于控制系统级处理器和系统级设置的系统寄存器，最后概述了处理器提供的系统级指令。\n\n\n[!IMPORTANT]所有Intel 64和IA-32处理器上电或复位后都会进入实模式，然后软件会完成实模式到保护模式的切换。如果需要运行IA-32e模式，软件也会完成保护模式到IA-32e模式的切换。\n\nSystem-Level Architecture系统级架构由一组寄存器、数据结构和指令组成，支持例如内存管理、中断和异常处理、任务管理以及多处理器控制等等这样的系统级操作。\n下图是32位模式的系统寄存器和数据结构：\n\n[!WARNING]下图点线箭头表示物理地址只在最后CR3处使用，除此之外都是虚线箭头表示段选择子。\n\n\nGlobal and Local Descriptor Tables在保护模式下的所有内存访问都会经过全局描述符表(GDT)或局部描述符(LDT)，这些表包含称为段描述符的条目，段描述符提供段的基地址、访问权限、类型以及使用信息。每个段描述符都有一个相关联的段选择子，段选择子提供指向GDT或LDT的索引、全局&#x2F;局部标志以及访问权限信息。\n要访问段中的某个字节，必须提供段选择子和偏移量。处理器通过段选择子访问段的段描述符，再通过段描述符获取段在线性地址空间的基地址，偏移量提供字节相对于基地址的位置。只要处理器当前运行的特权级别(CPL)允许访问段，就可以通过这种机制访问任何有效的代码段、数据段或堆栈段。\nSystem Segments, Segment Descriptors, and Gates除了代码段、数据段和堆栈段之外，还有两个系统段：任务状态段(TSS)和LDT。注意GDT不是段，因为它不通过段选择子和段描述符访问。TSS和LDT都定义了各自的段描述符。\n描述符表中除了段描述符还有一组称为”门”(调用门，中断门，陷阱门和任务门)的特殊描述符。这些门为系统程序和处理程序提供受保护的入口，并且这些程序可能以与应用程序和大部分程序不同的权限级别运行，例如调用调用门可以访问代码段中与当前代码段权限级别相同或数值更低(权限更高)的程序，要通过调用门访问程序，调用程序需要提供调用门选择子，然后处理器对调用门执行访问权限检查，将代码段权限级别(CPL)与调用门的权限级别以及调用门指向的目标代码段进行比较。\n","categories":["Intel SDM"],"tags":["Volume 3A"]}]